<!doctype html><html lang=zh-CN><head><title>Requests Encoding - 世界的过客</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The HTML5 Herald"><meta name=author content="Jay Lau"><meta property="og:title" content="Requests Encoding"><meta property="og:description" content="问题 我一直以为按照meta去搞编码就ok了，然而事实上是然并卵。。例子之一是199IT的网页，看到meta charset=&ldquo;utf-8&rdquo; 在使用requests获取网页的时候，发现搞下来的中文文本都是乱码(response."><meta property="og:type" content="article"><meta property="og:url" content="https://laujay.com/posts/requests-encoding/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-08-24T20:48:15+08:00"><meta property="article:modified_time" content="2016-08-24T20:48:15+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Requests Encoding"><meta name=twitter:description content="问题 我一直以为按照meta去搞编码就ok了，然而事实上是然并卵。。例子之一是199IT的网页，看到meta charset=&ldquo;utf-8&rdquo; 在使用requests获取网页的时候，发现搞下来的中文文本都是乱码(response."><meta name=generator content="Hugo 0.121.1"><link rel="shortcut icon" href=https://laujay.com/img/favicon.ico><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://laujay.com/fontawesome/css/all.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"><link rel=stylesheet type=text/css href=https://laujay.com/css/styles.css></head><body><div id=container><header><h1><a href=https://laujay.com/>世界的过客</a></h1><ul id=social-media><li><a href=https://github.com/lau-jay title=GitHub><i class="fab fa-github fa-lg"></i></a></li></ul><p><em>每个人获得的东西都恰好是他值得获得的东西</em></p></header><nav><ul><li><a href=https://laujay.com/about><i class="fa-li fa fa-lg"></i><span>About</span></a></li><li><a href=https://laujay.com/categories><i class="fa-li fa fa-lg"></i><span>Categories</span></a></li><li><a href=https://laujay.com/tags><i class="fa-li fa fa-lg"></i><span>Tags</span></a></li></ul></nav><main><article><h1>Requests Encoding</h1><aside><ul><li><time class=post-date datetime=2016-08-24T20:48:15+08:00>Aug 24, 2016</time></li><li>Categories:
<em><a href=https://laujay.com/categories/python>python</a></em></li><li><em><a href=https://laujay.com/tags/requests>#requests</a>
,
<a href=https://laujay.com/tags/encoding>#encoding</a></em></li><li>One minute read</li></ul></aside><div class=featured_image><a href=https://laujay.com/posts/requests-encoding/ title="Requests Encoding"><img src></a></div><h2 id=问题>问题</h2><p>我一直以为按照meta去搞编码就ok了，然而事实上是然并卵。。例子之一是199IT的网页，看到meta charset=&ldquo;utf-8&rdquo;
在使用requests获取网页的时候，发现搞下来的中文文本都是乱码(response.text)。于是一脸懵逼的开始转码，开始试都不行直到试到了ISO－8859-1
于是我就奇怪了，怎么搞的，然后我就开始搜索和研究。</p><h2 id=试验>试验</h2><p>第一步自然是怀疑requests了，因为我试过用wget获取发现毫无问题。
于是就去看requests文档，发现了这么一段：</p><p><code>When you receive a response, Requests makes a guess at the encoding to use for decoding the response when you access the Response.text attribute. Requests will first check for an encoding in the HTTP header, and if none is present, will use chardet to attempt to guess the encoding. The only time Requests will not do this is if no explicit charset is present in the HTTP headersand the Content-Type header contains text. In this situation, RFC 2616 specifies that the default charset must be ISO-8859-1. Requests follows the specification in this case. If you require a different encoding, you can manually set the Response.encoding property, or use the rawResponse.content.</code></p><p>然后我打印requests的response.encoding..结果是：</p><pre><code>ISO－8859-1
</code></pre><h2 id=解决>解决</h2><p>找到问题后直接</p><pre><code>response.encoding=&quot;utf-8&quot;
</code></pre><p>搞定</p></article><section class=post-nav><ul><li><a href=https://laujay.com/posts/pyspider-docker-deployment/><i class="fa fa-chevron-circle-left"></i> Pyspider Docker Deployment</a></li><li><a href=https://laujay.com/posts/glob/>glob <i class="fa fa-chevron-circle-right"></i></a></li></ul></section><section class=comments-block><button id=show-comments style=display:none><i class="fa fa-comments"></i> Add/View Comments</button></section><section id=disqus_thread></section><script>(function(){if(window.location.hostname=="localhost")return;var t,n=!1,o="lau-jay",s=document.getElementById("show-comments"),i=!0,a=null;if(a)return;s.style.display="",i?e():s.addEventListener("click",e,!1);function e(){if(!n){n=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+o+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e),document.getElementById("show-comments").style.display="none"}}t=window.location.hash.substr(1),t.length>8&&t.substring(0,8)=="comment-"&&e(),/bot|google|baidu|bing|msn|duckduckgo|slurp|yandex/i.test(navigator.userAgent)&&e()})()</script></main><footer><h6>Copyright © 2016 ~ 2023 - Jay Lau|Theme by <a href=https://github.com/funkydan2/hugo-kiera>kiera</a> |
Rendered by <a href=https://gohugo.io title=Hugo>Hugo</a> |
<a href=https://laujay.com/index.xml>Subscribe</a></h6></footer></div><script src=https://laujay.com/js/scripts.js></script><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-91611718-2","auto"),ga("send","pageview"))</script></body></html>