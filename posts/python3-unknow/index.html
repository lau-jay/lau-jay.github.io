<!doctype html><html lang=zh-CN><head><title>不知道的Python3特性 - 世界的过客</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The HTML5 Herald"><meta name=author content="Jay Lau"><meta property="og:title" content="不知道的Python3特性"><meta property="og:description" content="下面这几个是我日常基本没使用过的特性。
高级解包 # in python2 In [2]: a, b = 1, 2 In [3]: a, b = b, a # now in python3 In [4]: a, b, *rest = range(10) In [5]: print(a) 0 In [6]: print(b) 1 In [7]: print(rest) [2, 3, 4, 5, 6, 7, 8, 9] In [8]: a, *rest, b = range(10) In [9]: print(a) 0 In [10]: print(rest) [1, 2, 3, 4, 5, 6, 7, 8] In [11]: print(b) 9 强制关键词参数 如果不想用*args收集多余参数你可能这么写"><meta property="og:type" content="article"><meta property="og:url" content="https://laujay.com/posts/python3-unknow/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-05-12T22:20:19+08:00"><meta property="article:modified_time" content="2018-05-12T22:20:19+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="不知道的Python3特性"><meta name=twitter:description content="下面这几个是我日常基本没使用过的特性。
高级解包 # in python2 In [2]: a, b = 1, 2 In [3]: a, b = b, a # now in python3 In [4]: a, b, *rest = range(10) In [5]: print(a) 0 In [6]: print(b) 1 In [7]: print(rest) [2, 3, 4, 5, 6, 7, 8, 9] In [8]: a, *rest, b = range(10) In [9]: print(a) 0 In [10]: print(rest) [1, 2, 3, 4, 5, 6, 7, 8] In [11]: print(b) 9 强制关键词参数 如果不想用*args收集多余参数你可能这么写"><meta name=generator content="Hugo 0.121.1"><link rel="shortcut icon" href=https://laujay.com/img/favicon.ico><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://laujay.com/fontawesome/css/all.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"><link rel=stylesheet type=text/css href=https://laujay.com/css/styles.css></head><body><div id=container><header><h1><a href=https://laujay.com/>世界的过客</a></h1><ul id=social-media><li><a href=https://github.com/lau-jay title=GitHub><i class="fab fa-github fa-lg"></i></a></li></ul><p><em>每个人获得的东西都恰好是他值得获得的东西</em></p></header><nav><ul><li><a href=https://laujay.com/about><i class="fa-li fa fa-lg"></i><span>About</span></a></li><li><a href=https://laujay.com/categories><i class="fa-li fa fa-lg"></i><span>Categories</span></a></li><li><a href=https://laujay.com/tags><i class="fa-li fa fa-lg"></i><span>Tags</span></a></li></ul></nav><main><article><h1>不知道的Python3特性</h1><aside><ul><li><time class=post-date datetime=2018-05-12T22:20:19+08:00>May 12, 2018</time></li><li>Categories:
<em><a href=https://laujay.com/categories/python>python</a></em></li><li><em><a href=https://laujay.com/tags/syntax>#syntax</a>
,
<a href=https://laujay.com/tags/stdlib>#stdlib</a></em></li><li>2 minute read</li></ul></aside><div class=featured_image><a href=https://laujay.com/posts/python3-unknow/ title=不知道的Python3特性><img src></a></div><p>下面这几个是我日常基本没使用过的特性。</p><h2 id=高级解包>高级解包</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># in python2</span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>2</span>]: a, b <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>3</span>]: a, b <span style=color:#f92672>=</span> b, a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># now in python3</span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>4</span>]: a, b, <span style=color:#f92672>*</span>rest <span style=color:#f92672>=</span> range(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>5</span>]: print(a)
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>6</span>]: print(b)
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>7</span>]: print(rest)
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>8</span>]: a, <span style=color:#f92672>*</span>rest, b <span style=color:#f92672>=</span> range(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>9</span>]: print(a)
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>10</span>]: print(rest)
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>11</span>]: print(b)
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>
</span></span></code></pre></div><h2 id=强制关键词参数>强制关键词参数</h2><p>如果不想用*args收集多余参数你可能这么写</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>14</span>]: <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>mysum</span>(a, b, biteme<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>):
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#66d9ef>if</span> biteme:
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:         print(<span style=color:#e6db74>&#39;一键删库&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:         <span style=color:#66d9ef>return</span> a <span style=color:#f92672>+</span> b
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>15</span>]: mysum(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>15</span>]: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>16</span>]: mysum(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>) <span style=color:#75715e># if this is delete DB?</span>
</span></span><span style=display:flex><span>一键删库
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>18</span>]: <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>mysum</span>(a, b, <span style=color:#f92672>*</span>, biteme<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>):
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#66d9ef>if</span> biteme:
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:         print(<span style=color:#e6db74>&#39;一键删库&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:         <span style=color:#66d9ef>return</span> a <span style=color:#f92672>+</span> b
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>19</span>]: mysum(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>) <span style=color:#75715e># now raise TypeError</span>
</span></span><span style=display:flex><span><span style=color:#f92672>---------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TypeError</span>                                 Traceback (most recent call last)
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span>ipython<span style=color:#f92672>-</span>input<span style=color:#f92672>-</span><span style=color:#ae81ff>19</span><span style=color:#f92672>-</span>eb8c192f30fb<span style=color:#f92672>&gt;</span> <span style=color:#f92672>in</span> <span style=color:#f92672>&lt;</span>module<span style=color:#f92672>&gt;</span>()
</span></span><span style=display:flex><span><span style=color:#f92672>----&gt;</span> <span style=color:#ae81ff>1</span> mysum(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TypeError</span>: mysum() takes <span style=color:#ae81ff>2</span> positional arguments but <span style=color:#ae81ff>3</span> were given
</span></span></code></pre></div><h2 id=新的标准库>新的标准库</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>22</span>]: <span style=color:#f92672>import</span> ipaddress
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>23</span>]: print(ipaddress<span style=color:#f92672>.</span>ip_address(<span style=color:#e6db74>&#39;192.168.0.1&#39;</span>))
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: print(ipaddress<span style=color:#f92672>.</span>ip_address(<span style=color:#e6db74>&#39;2001:db8::&#39;</span>))
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:
</span></span><span style=display:flex><span><span style=color:#ae81ff>192.168.0.1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2001</span>:db8::
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>24</span>]: <span style=color:#f92672>from</span> functools <span style=color:#f92672>import</span> lru_cache
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: <span style=color:#f92672>from</span> urllib.error <span style=color:#f92672>import</span> HTTPError
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: <span style=color:#f92672>import</span> urllib.request
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>25</span>]: <span style=color:#a6e22e>@lru_cache</span>(maxsize<span style=color:#f92672>=</span><span style=color:#ae81ff>32</span>)
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_pep</span>(num):
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#e6db74>&#39;Retrieve text of a Python Enhancement Proposal&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     resource <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://www.python.org/dev/peps/pep-</span><span style=color:#e6db74>%04d</span><span style=color:#e6db74>/&#39;</span> <span style=color:#f92672>%</span> num
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:         <span style=color:#66d9ef>with</span> urllib<span style=color:#f92672>.</span>request<span style=color:#f92672>.</span>urlopen(resource) <span style=color:#66d9ef>as</span> s:
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:             <span style=color:#66d9ef>return</span> s<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#66d9ef>except</span> HTTPError:
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:         <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;Not Found&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:
</span></span></code></pre></div><h2 id=pahtlib>pahtlib</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>directory <span style=color:#f92672>=</span> Path(<span style=color:#e6db74>&#34;/etc&#34;</span>)
</span></span><span style=display:flex><span>filepath <span style=color:#f92672>=</span> directory <span style=color:#f92672>/</span> <span style=color:#e6db74>&#34;hosts&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> filepath<span style=color:#f92672>.</span>exists():
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;hosts exist&#39;</span>)
</span></span></code></pre></div><p>这个比通常用os库做的优雅多了。。特别是filepath这句特别黑魔法, 把dunder方法<code>__div__</code>用的很溜。</p></article><section class=post-nav><ul><li><a href=https://laujay.com/posts/tornado-run-blocking-function/><i class="fa fa-chevron-circle-left"></i> Tornado执行阻塞函数</a></li><li><a href=https://laujay.com/posts/pathlib/>Pathlib <i class="fa fa-chevron-circle-right"></i></a></li></ul></section><section class=comments-block><button id=show-comments style=display:none><i class="fa fa-comments"></i> Add/View Comments</button></section><section id=disqus_thread></section><script>(function(){if(window.location.hostname=="localhost")return;var t,n=!1,o="lau-jay",s=document.getElementById("show-comments"),i=!0,a=null;if(a)return;s.style.display="",i?e():s.addEventListener("click",e,!1);function e(){if(!n){n=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+o+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e),document.getElementById("show-comments").style.display="none"}}t=window.location.hash.substr(1),t.length>8&&t.substring(0,8)=="comment-"&&e(),/bot|google|baidu|bing|msn|duckduckgo|slurp|yandex/i.test(navigator.userAgent)&&e()})()</script></main><footer><h6>Copyright © 2016 ~ 2023 - Jay Lau|Theme by <a href=https://github.com/funkydan2/hugo-kiera>kiera</a> |
Rendered by <a href=https://gohugo.io title=Hugo>Hugo</a> |
<a href=https://laujay.com/index.xml>Subscribe</a></h6></footer></div><script src=https://laujay.com/js/scripts.js></script><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-91611718-2","auto"),ga("send","pageview"))</script></body></html>